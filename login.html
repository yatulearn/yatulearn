<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" href="css/login.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>

<div class="container">
    <div class="form-container">
        <div class="logo">
            <img src="assets/images/yatu whole white.png" alt="YATU Logo" class="logo-img">
            <span class="logo-text">YATU</span>
        </div>
        <h1>Welcome Back!</h1>
        <p>Please enter login details below</p>
        <form id="loginForm">
            <label for="email">Email</label>
            <input type="email" id="login-email" placeholder="Enter the email" required>

            <label for="password">Password</label>
            <input type="password" id="login-password" placeholder="Enter the password" required>

            <a href="#">Forgot password?</a>

            <button type="submit" class="btn">Sign In</button>
        </form>
        <div class="or">
            <hr> <span>Or continue</span> <hr>
        </div>
        <button class="google-btn"><i class="fab fa-google"></i> Log in with Google</button>
        <button class="github-btn"><i class="fab fa-github"></i> Log in with GitHub</button>
        <div class="signup-link">
            <p>Don't have an account?</p>
            <a href="signin.html">Sign up</a>
        </div>
    </div>

    <div class="image-container">
        <img src="assets/images/blue books.jpeg" alt="Task Illustration">
        <p>Manage your tasks in a more efficient way with Tasky...</p>
    </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-app.js";
  import { getAuth, signInWithPopup, GoogleAuthProvider, GithubAuthProvider, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.17.2/firebase-auth.js";

  // Firebase configuration
  const firebaseConfig = {
      apiKey: "AIzaSyAislt1-eq2SDu1HH3wpSYoZRae2oTvjD4",
      authDomain: "yatu-learn.firebaseapp.com",
      projectId: "yatu-learn",
      storageBucket: "yatu-learn.appspot.com",
      messagingSenderId: "252805010346",
      appId: "1:252805010346:web:bfbc943ee9248609d611d3",
      measurementId: "G-7N2BPPBNHB"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // Google Sign-In
  const googleProvider = new GoogleAuthProvider();
  document.querySelector('.google-btn').addEventListener('click', () => {
      signInWithPopup(auth, googleProvider)
          .then((result) => {
              alert('Google sign-in successful:'+ result.user);
              window.location.href = 'index.html';
              localStorage.setItem("isLoggedIn", "true"); // Set login status
          })
          .catch((error) => {
             alert('Error during Google sign-in: ' + error.message);
          });
  });

  // GitHub Sign-In
  const githubProvider = new GithubAuthProvider();
  document.querySelector('.github-btn').addEventListener('click', () => {
      signInWithPopup(auth, githubProvider)
          .then((result) => {
              alert('GitHub sign-in successful:'+ result.user);
              window.location.href = 'index.html';
              localStorage.setItem("isLoggedIn", "true"); // Set login status
          })
          .catch((error) => {
              alert('Error during GitHub sign-in: ' + error.message);
          });
  });

  // Login User Function
  const loginUser = (email, password) => {
    signInWithEmailAndPassword(auth, email, password)
        .then((userCredential) => {
            const user = userCredential.user;
            localStorage.setItem("isLoggedIn", "true"); // Set login status
            alert("Logged in: " + user.email);
            window.location.href = 'index.html';
        })
        .catch((error) => {
            const errorCode = error.code;
            const errorMessage = error.message;
            alert("Login Error: " + errorCode + " " + errorMessage);
        });
  };

  // Login Form Event Listener
  document.getElementById('loginForm').addEventListener('submit', (event) => {
        event.preventDefault();
        const email = document.getElementById('login-email').value;
        const password = document.getElementById('login-password').value;
        loginUser(email, password);
    });
</script>
</body>
</html>
